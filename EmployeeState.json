{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "description": "A simple radial chart with embedded data.",
    "data": {
      "url": "https://raw.githubusercontent.com/joeechua/FIT3179_A2/main/fortune_500_USA.csv"
    },
    "background": null,
    "width": 500,
    "height": 330,
    "params": [
        {
          "name": "year_selection",
          "bind": {
            "input": "select",
            "options": [null, "2019", "2020", "2021"],
            "labels": ["Overall", "2019", "2020", "2021"],
            "name": "Select Year: "
          }
        }
      ],
    "transform": [{"filter":"year_selection == null || year_selection == datum.year"},{
        "window": [{
          "op": "rank",
          "as": "rank"
        }],
        "sort": [{ "field": "employees", "order": "descending" }]
      }, {
        "filter": "datum.rank <= 10"
      }],
    "layer": [{
      "mark": {"type": "arc", "innerRadius": 95, "stroke": "black"}
    },{
      "mark": {"type": "text", "radiusOffset": 20}
    }],
    "encoding": {
      "theta": {"field": "employees", "type": "quantitative", "stack": true, "scale":{"type":"linear","rangeMax":4.7, "rangeMin":1.5708}},
      "radius": {"field": "employees", "scale": {"type": "sqrt", "zero": true, "rangeMin": 70}},
      "angle": {},
      "color": {"field": "hqstate", "type": "nominal", "legend": {
            "title": "State",
            "titleFontSize": 13,
            "labelFontSize": 12,
            "titleLimit": 1000,
            "titlePadding": 10,
            "labelOffset": 13,
            "orient":"none",
            "legendX":450,
            "legendY":165
          }},
      "tooltip": [
        {
          "field": "name",
          "type":"ordinal",
          "title": "Company"
        },
        {
          "field": "employees",
          "type":"quantitative",
          "title": "Number of Employees"
        },
        {
          "field": "year",
          "type":"nominal",
          "title": "Year Listed"
        }
      ]
    }
  }
  